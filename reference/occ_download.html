<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Spin up a download request for GBIF occurrence data. — occ_download • rgbif</title><!-- rOpenSci favicons --><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Spin up a download request for GBIF occurrence data. — occ_download"><meta name="description" content="Spin up a download request for GBIF occurrence data."><meta property="og:description" content="Spin up a download request for GBIF occurrence data."><meta property="og:image" content="https://docs.ropensci.org/rgbif/logo.png"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.css"><script src="https://cdn.jsdelivr.net/gh/orestbida/cookieconsent@v3.0.0/dist/cookieconsent.umd.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">rgbif</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">3.8.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="nav-link" href="../articles/rgbif.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/creating_maps_from_occurrences.html">Creating maps from occurrences</a></li>
    <li><a class="dropdown-item" href="../articles/downloading_a_long_species_list.html">Downloading A Long Species List</a></li>
    <li><a class="dropdown-item" href="../articles/effectively_using_occ_search.html">Effectively using occ_search</a></li>
    <li><a class="dropdown-item" href="../articles/gbif_citations.html">Citing GBIF Mediated Data</a></li>
    <li><a class="dropdown-item" href="../articles/gbif_credentials.html">Set Up Your GBIF Username and Password</a></li>
    <li><a class="dropdown-item" href="../articles/gbif_sql_downloads.html">GBIF SQL Downloads</a></li>
    <li><a class="dropdown-item" href="../articles/getting_dataset_info.html">Getting Dataset Metadata From GBIF</a></li>
    <li><a class="dropdown-item" href="../articles/getting_occurrence_data.html">Getting Occurrence Data From GBIF</a></li>
    <li><a class="dropdown-item" href="../articles/multiple_values.html">Multiple Values</a></li>
    <li><a class="dropdown-item" href="../articles/occ_counts.html">Getting Occurrence Counts From GBIF</a></li>
    <li><a class="dropdown-item" href="../articles/taxonomic_names.html">Working With Taxonomic Names</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ropensci/rgbif/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Spin up a download request for GBIF occurrence data.</h1>
      <small class="dont-index">Source: <a href="https://github.com/ropensci/rgbif/blob/master/R/occ_download.R" class="external-link"><code>R/occ_download.R</code></a></small>
      <div class="d-none name"><code>occ_download.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Spin up a download request for GBIF occurrence data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">occ_download</span><span class="op">(</span></span>
<span>  <span class="va">...</span>,</span>
<span>  body <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"and"</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"DWCA"</span>,</span>
<span>  user <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pwd <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  email <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  curlopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">occ_download_prep</span><span class="op">(</span></span>
<span>  <span class="va">...</span>,</span>
<span>  body <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"and"</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"DWCA"</span>,</span>
<span>  user <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pwd <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  email <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  curlopts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>For <code>occ_download()</code> and <code>occ_download_prep()</code>, one or more
objects of class <code>occ_predicate</code> or <code>occ_predicate_list</code>, created by
<code>pred*</code> functions (see <a href="download_predicate_dsl.html">download_predicate_dsl</a>). If you use this, don't
use <code>body</code> parameter.</p></dd>


<dt id="arg-body">body<a class="anchor" aria-label="anchor" href="#arg-body"></a></dt>
<dd><p>if you prefer to pass in the payload yourself, use this
parameter. If you use this, don't pass anything to the dots. Accepts
either an R list, or JSON. JSON is likely easier, since the JSON
library <span class="pkg">jsonlite</span> requires that you unbox strings that shouldn't
be auto-converted to arrays, which is a bit tedious for large queries.
optional</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>(character) One of equals (=), and (&amp;), or (|), lessThan (&lt;),
lessThanOrEquals (&lt;=), greaterThan (&gt;), greaterThanOrEquals (&gt;=), in,
within, not (!), like, isNotNull</p></dd>


<dt id="arg-format">format<a class="anchor" aria-label="anchor" href="#arg-format"></a></dt>
<dd><p>(character) The download format. One of 'DWCA' (default),
'SIMPLE_CSV', or 'SPECIES_LIST'</p></dd>


<dt id="arg-user">user<a class="anchor" aria-label="anchor" href="#arg-user"></a></dt>
<dd><p>(character) User name within GBIF's website. Required. See
"Authentication" below</p></dd>


<dt id="arg-pwd">pwd<a class="anchor" aria-label="anchor" href="#arg-pwd"></a></dt>
<dd><p>(character) User password within GBIF's website. Required. See
"Authentication" below</p></dd>


<dt id="arg-email">email<a class="anchor" aria-label="anchor" href="#arg-email"></a></dt>
<dd><p>(character) Email address to receive download notice done
email. Required. See "Authentication" below</p></dd>


<dt id="arg-curlopts">curlopts<a class="anchor" aria-label="anchor" href="#arg-curlopts"></a></dt>
<dd><p>list of named curl options passed on to
<code><a href="https://docs.ropensci.org/crul/reference/HttpClient.html" class="external-link">HttpClient</a></code>. see <code><a href="https://rdrr.io/pkg/curl/man/curl_options.html" class="external-link">curl::curl_options</a></code>
for curl options</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>see <a href="downloads.html">downloads</a> for an overview of GBIF downloads methods</p>
    </div>
    <div class="section level2">
    <h2 id="geometry">geometry<a class="anchor" aria-label="anchor" href="#geometry"></a></h2>


<p>When using the geometry parameter, make sure that your well known text
(WKT) is formatted as GBIF expects it. They expect WKT to have a
counter-clockwise winding order. For example, the following is clockwise
<code>POLYGON((-19.5 34.1, -25.3 68.1, 35.9 68.1, 27.8 34.1, -19.5 34.1))</code>,
whereas they expect the other order:
<code>POLYGON((-19.5 34.1, 27.8 34.1, 35.9 68.1, -25.3 68.1, -19.5 34.1))</code></p>
<p>note that coordinate pairs are <code>longitude latitude</code>, longitude first, then
latitude</p>
<p>you should not get any results if you supply WKT that has clockwise
winding order.</p>
<p>also note that <code><a href="occ_search.html">occ_search()</a></code>/<code><a href="occ_data.html">occ_data()</a></code> behave differently with
respect to WKT in that you can supply clockwise WKT to those
functions but they treat it as an exclusion, so get all data not
inside the WKT area.</p>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>


<ul><li><p><code>occ_download_prep</code>: prepares a download request, but DOES NOT execute it.
meant for use with <code><a href="occ_download_queue.html">occ_download_queue()</a></code></p></li>
<li><p><code>occ_download</code>: prepares a download request and DOES execute it</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="authentication">Authentication<a class="anchor" aria-label="anchor" href="#authentication"></a></h2>


<p>For <code>user</code>, <code>pwd</code>, and <code>email</code> parameters, you can set them in one of
three ways:</p><ul><li><p>Set them in your <code>.Rprofile</code> file with the names <code>gbif_user</code>,
<code>gbif_pwd</code>, and <code>gbif_email</code></p></li>
<li><p>Set them in your <code>.Renviron</code>/<code>.bash_profile</code> (or similar) file with the
names <code>GBIF_USER</code>, <code>GBIF_PWD</code>, and <code>GBIF_EMAIL</code></p></li>
<li><p>Simply pass strings to each of the parameters in the function
call</p></li>
</ul><p>We strongly recommend the second option - storing your details as
environment variables as it's the most widely used way to store secrets.</p>
<p>See <code><a href="https://rdrr.io/r/base/Startup.html" class="external-link">?Startup</a></code> for help.</p>
    </div>
    <div class="section level2">
    <h2 id="query-length">Query length<a class="anchor" aria-label="anchor" href="#query-length"></a></h2>


<p>GBIF has a limit of 12,000 characters for a download query. This means
that you can have a pretty long query, but at some point it may lead to an
error on GBIF's side and you'll have to split your query into a few.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>See the API docs
<a href="https://www.gbif.org/developer/occurrence#download" class="external-link">https://www.gbif.org/developer/occurrence#download</a> for more info,
and the predicates docs
<a href="https://www.gbif.org/developer/occurrence#predicates" class="external-link">https://www.gbif.org/developer/occurrence#predicates</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other downloads:
<code><a href="download_predicate_dsl.html">download_predicate_dsl</a></code>,
<code><a href="occ_download_cached.html">occ_download_cached</a>()</code>,
<code><a href="occ_download_cancel.html">occ_download_cancel</a>()</code>,
<code><a href="occ_download_dataset_activity.html">occ_download_dataset_activity</a>()</code>,
<code><a href="occ_download_datasets.html">occ_download_datasets</a>()</code>,
<code><a href="occ_download_get.html">occ_download_get</a>()</code>,
<code><a href="occ_download_import.html">occ_download_import</a>()</code>,
<code><a href="occ_download_list.html">occ_download_list</a>()</code>,
<code><a href="occ_download_meta.html">occ_download_meta</a>()</code>,
<code><a href="occ_download_queue.html">occ_download_queue</a>()</code>,
<code><a href="occ_download_wait.html">occ_download_wait</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># occ_download(pred("basisOfRecord", "LITERATURE"))</span></span></span>
<span class="r-in"><span><span class="co"># occ_download(pred("taxonKey", 3119195), pred_gt("elevation", 5000))</span></span></span>
<span class="r-in"><span><span class="co"># occ_download(pred_gt("decimalLatitude", 50))</span></span></span>
<span class="r-in"><span><span class="co"># occ_download(pred_gte("elevation", 9000))</span></span></span>
<span class="r-in"><span><span class="co"># occ_download(pred_gte('decimalLatitude", 65))</span></span></span>
<span class="r-in"><span><span class="co"># occ_download(pred("country", "US"))</span></span></span>
<span class="r-in"><span><span class="co"># occ_download(pred("institutionCode", "TLMF"))</span></span></span>
<span class="r-in"><span><span class="co"># occ_download(pred("catalogNumber", 217880))</span></span></span>
<span class="r-in"><span><span class="co"># occ_download(pred("gbifId", 142317604)) </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># download format</span></span></span>
<span class="r-in"><span><span class="co"># z &lt;- occ_download(pred_gte("decimalLatitude", 75),</span></span></span>
<span class="r-in"><span><span class="co">#  format = "SPECIES_LIST")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># res &lt;- occ_download(pred("taxonKey", 7264332), pred("hasCoordinate", TRUE))</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># pass output directly, or later, to occ_download_meta for more information</span></span></span>
<span class="r-in"><span><span class="co"># occ_download(pred_gt('decimalLatitude', 75)) %&gt;% occ_download_meta</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Multiple queries</span></span></span>
<span class="r-in"><span><span class="co"># occ_download(pred_gte("decimalLatitude", 65),</span></span></span>
<span class="r-in"><span><span class="co">#  pred_lte("decimalLatitude", -65), type="or")</span></span></span>
<span class="r-in"><span><span class="co"># gg &lt;- occ_download(pred("depth", 80), pred("taxonKey", 2343454),</span></span></span>
<span class="r-in"><span><span class="co">#  type="or")</span></span></span>
<span class="r-in"><span><span class="co"># x &lt;- occ_download(pred_and(pred_within("POLYGON((-14 42, 9 38, -7 26, -14 42))"),</span></span></span>
<span class="r-in"><span><span class="co">#  pred_gte("elevation", 5000)))</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># complex example with many predicates</span></span></span>
<span class="r-in"><span><span class="co"># shows example of how to do date ranges for both year and month</span></span></span>
<span class="r-in"><span><span class="co"># res &lt;- occ_download(</span></span></span>
<span class="r-in"><span><span class="co">#  pred_gt("elevation", 5000),</span></span></span>
<span class="r-in"><span><span class="co">#  pred_in("basisOfRecord", c('HUMAN_OBSERVATION','OBSERVATION','MACHINE_OBSERVATION')),</span></span></span>
<span class="r-in"><span><span class="co">#  pred("country", "US"),</span></span></span>
<span class="r-in"><span><span class="co">#  pred("hasCoordinate", TRUE),</span></span></span>
<span class="r-in"><span><span class="co">#  pred("hasGeospatialIssue", FALSE),</span></span></span>
<span class="r-in"><span><span class="co">#  pred_gte("year", 1999),</span></span></span>
<span class="r-in"><span><span class="co">#  pred_lte("year", 2011),</span></span></span>
<span class="r-in"><span><span class="co">#  pred_gte("month", 3),</span></span></span>
<span class="r-in"><span><span class="co">#  pred_lte("month", 8)</span></span></span>
<span class="r-in"><span><span class="co"># )</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using body parameter - pass in your own complete query</span></span></span>
<span class="r-in"><span><span class="co">## as JSON</span></span></span>
<span class="r-in"><span><span class="va">query1</span> <span class="op">&lt;-</span> <span class="st">'{"creator":"sckott",</span></span></span>
<span class="r-in"><span><span class="st">  "notification_address":["stuff1@gmail.com"],</span></span></span>
<span class="r-in"><span><span class="st">  "predicate":{"type":"and","predicates":[</span></span></span>
<span class="r-in"><span><span class="st">    {"type":"equals","key":"TAXON_KEY","value":"7264332"},</span></span></span>
<span class="r-in"><span><span class="st">    {"type":"equals","key":"HAS_COORDINATE","value":"TRUE"}]}</span></span></span>
<span class="r-in"><span><span class="st"> }'</span></span></span>
<span class="r-in"><span><span class="co"># res &lt;- occ_download(body = query1, curlopts=list(verbose=TRUE))</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## as a list</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jeroen.r-universe.dev/jsonlite" class="external-link">jsonlite</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">query</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  creator <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/unbox.html" class="external-link">unbox</a></span><span class="op">(</span><span class="st">"sckott"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  notification_address <span class="op">=</span> <span class="st">"stuff1@gmail.com"</span>,</span></span>
<span class="r-in"><span>  predicate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/unbox.html" class="external-link">unbox</a></span><span class="op">(</span><span class="st">"and"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    predicates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/unbox.html" class="external-link">unbox</a></span><span class="op">(</span><span class="st">"equals"</span><span class="op">)</span>, key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/unbox.html" class="external-link">unbox</a></span><span class="op">(</span><span class="st">"TAXON_KEY"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/unbox.html" class="external-link">unbox</a></span><span class="op">(</span><span class="st">"7264332"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/unbox.html" class="external-link">unbox</a></span><span class="op">(</span><span class="st">"equals"</span><span class="op">)</span>, key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/unbox.html" class="external-link">unbox</a></span><span class="op">(</span><span class="st">"HAS_COORDINATE"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/unbox.html" class="external-link">unbox</a></span><span class="op">(</span><span class="st">"TRUE"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># res &lt;- occ_download(body = query, curlopts = list(verbose = TRUE))</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Prepared query</span></span></span>
<span class="r-in"><span><span class="fu">occ_download_prep</span><span class="op">(</span><span class="fu"><a href="download_predicate_dsl.html">pred</a></span><span class="op">(</span><span class="st">"basisOfRecord"</span>, <span class="st">"LITERATURE"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">occ_download_prep</span><span class="op">(</span><span class="fu"><a href="download_predicate_dsl.html">pred</a></span><span class="op">(</span><span class="st">"basisOfRecord"</span>, <span class="st">"LITERATURE"</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"SIMPLE_CSV"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">occ_download_prep</span><span class="op">(</span><span class="fu"><a href="download_predicate_dsl.html">pred</a></span><span class="op">(</span><span class="st">"basisOfRecord"</span>, <span class="st">"LITERATURE"</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"SPECIES_LIST"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">occ_download_prep</span><span class="op">(</span><span class="fu"><a href="download_predicate_dsl.html">pred_in</a></span><span class="op">(</span><span class="st">"taxonKey"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2977832</span>, <span class="fl">2977901</span>, <span class="fl">2977966</span>, <span class="fl">2977835</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">occ_download_prep</span><span class="op">(</span><span class="fu"><a href="download_predicate_dsl.html">pred_within</a></span><span class="op">(</span><span class="st">"POLYGON((-14 42, 9 38, -7 26, -14 42))"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## a complicated example</span></span></span>
<span class="r-in"><span><span class="fu">occ_download_prep</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="download_predicate_dsl.html">pred_in</a></span><span class="op">(</span><span class="st">"basisOfRecord"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MACHINE_OBSERVATION"</span>, <span class="st">"HUMAN_OBSERVATION"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="download_predicate_dsl.html">pred_in</a></span><span class="op">(</span><span class="st">"taxonKey"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2498343</span>, <span class="fl">2481776</span>, <span class="fl">2481890</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="download_predicate_dsl.html">pred_in</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GB"</span>, <span class="st">"IE"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="download_predicate_dsl.html">pred_or</a></span><span class="op">(</span><span class="fu"><a href="download_predicate_dsl.html">pred_lte</a></span><span class="op">(</span><span class="st">"year"</span>, <span class="fl">1989</span><span class="op">)</span>, <span class="fu"><a href="download_predicate_dsl.html">pred</a></span><span class="op">(</span><span class="st">"year"</span>, <span class="fl">2000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># x = occ_download(</span></span></span>
<span class="r-in"><span><span class="co">#   pred_in("basisOfRecord", c("MACHINE_OBSERVATION", "HUMAN_OBSERVATION")),</span></span></span>
<span class="r-in"><span><span class="co">#   pred_in("taxonKey", c(9206251, 3112648)),</span></span></span>
<span class="r-in"><span><span class="co">#   pred_in("country", c("US", "MX")),</span></span></span>
<span class="r-in"><span><span class="co">#   pred_and(pred_gte("year", 1989), pred_lte("year", 1991))</span></span></span>
<span class="r-in"><span><span class="co"># )</span></span></span>
<span class="r-in"><span><span class="co"># occ_download_meta(x)</span></span></span>
<span class="r-in"><span><span class="co"># z &lt;- occ_download_get(x)</span></span></span>
<span class="r-in"><span><span class="co"># df &lt;- occ_download_import(z)</span></span></span>
<span class="r-in"><span><span class="co"># str(df)</span></span></span>
<span class="r-in"><span><span class="co"># library(dplyr)</span></span></span>
<span class="r-in"><span><span class="co"># unique(df$basisOfRecord)</span></span></span>
<span class="r-in"><span><span class="co"># unique(df$taxonKey)</span></span></span>
<span class="r-in"><span><span class="co"># unique(df$countryCode)</span></span></span>
<span class="r-in"><span><span class="co"># sort(unique(df$year))</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg"></div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul></div>
                    <div class="col-md-3 col-sm-4">
                        <ul><h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul></div>
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul></div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer></div>





  </body></html>

